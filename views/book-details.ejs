<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>
        <%= book.BookName %>
    </title>
</head>

<body>
    <h1>
        <%= book.BookName %>
    </h1>

    <p>
        <strong>Author:</strong>
        <%= book.BookAuthor %>
    </p>

    <% if (book.BookImage) { %>
        <div>
            <img src="<%= book.BookImage %>" alt="<%= book.BookName %>" width="200" />
        </div>
        <% } %>

            <section>
                <h2>Description</h2>
                <p>
                    <%= book.Description %>
                </p>
            </section>

            <section>
                <h2>Average Rating</h2>
                <% if (!displayAvgRating) { %>
                    <p>Not rated yet</p>
                <% } else { %>
                    <p> Book Rating: <%= displayAvgRating %></p>
                <% } %>
                </section>
            <form method="POST" action="/books/<%= book.id %>/ratings">
                <label for="rating">Rate this book:</label>
            
                <select name="rating" id="rating" required>
                    <option value="">-- Select --</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                </select>
            
                <button type="submit">Submit Rating</button>
            </form>

            <!-- Placeholder for reviews -->
            <section>
                <h2>Reviews</h2>
                
                <% if (reviews.length===0) { %>
                    <p>No reviews yet.</p>
                    <% } else { %>
                        <ul>
                            <% reviews.forEach(r=> { %>
                                <li>
                                    <%= r.review %>
                                </li>
                                <% }) %>
                        </ul>
                        <% } %>

            </section>
            <h2>Add a Review</h2>
            
            <form method="POST" action="/books/<%= book.id %>/reviews">
                <div>
                    <label for="reviewText">Your review</label>
                </div>
            
                <div>
                    <textarea id="reviewText" name="reviewText" rows="4" required></textarea>
                </div>
            
                <button type="submit">Submit Review</button>
            </form>

            <form method="POST" action="/books/<%= book.id %>/delete">
                <button type="submit">Delete</button>
            </form>

            <p>
                <a href="/books">Back to book list</a>
            </p>
</body>

</html>